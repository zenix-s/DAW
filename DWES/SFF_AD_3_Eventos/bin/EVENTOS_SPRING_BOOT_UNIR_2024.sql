CREATE DATABASE IF NOT EXISTS EVENTOS_SPRING_BOOT_UNIR_2024;
USE EVENTOS_SPRING_BOOT_UNIR_2024;

CREATE TABLE IF NOT EXISTS TIPOS
(ID_TIPO INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
NOMBRE VARCHAR(45) NOT NULL,
DESCRIPCION VARCHAR(200)
);


CREATE TABLE IF NOT EXISTS EVENTOS
(ID_EVENTO INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
NOMBRE VARCHAR(50) NOT NULL,
DESCRIPCION VARCHAR(200),
FECHA_INICIO DATE,
DURACION INT,
DIRECCION VARCHAR(100),
ESTADO VARCHAR(20),
DESTACADO CHAR(1),
AFORO_MAXIMO INT,
MINIMO_ASISTENCIA INT,
PRECIO DEC(9,2),
ID_TIPO INT NOT NULL,
FOREIGN KEY(ID_TIPO) REFERENCES TIPOS(ID_TIPO)
);

CREATE TABLE IF NOT EXISTS USUARIOS
(
USERNAME VARCHAR(45) NOT NULL PRIMARY KEY,
PASSWORD VARCHAR(200) NOT NULL,
NOMBRE VARCHAR(50),
APELLIDOS VARCHAR(50),
DIRECCION VARCHAR(100),
ENABLED INT NOT NULL DEFAULT 1,
FECHA_REGISTRO DATE
);


CREATE TABLE IF NOT EXISTS RESERVAS
(ID_RESERVA INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
ID_EVENTO INT NOT NULL,
USERNAME VARCHAR(45) NOT NULL,
PRECIO_VENTA DEC(9,2),
OBSERVACIONES VARCHAR(200),
CANTIDAD INT,
FOREIGN KEY(USERNAME) REFERENCES USUARIOS(USERNAME),
FOREIGN KEY(ID_EVENTO) REFERENCES EVENTOS(ID_EVENTO)
);

-- TABLAS PARA LOGIN, LOGOUT y REGISTRO o  SPRING SECURITY 

CREATE TABLE IF NOT EXISTS PERFILES
(ID_PERFIL INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
NOMBRE VARCHAR(45) NOT NULL
);


CREATE TABLE IF NOT EXISTS USUARIO_PERFILES
(USERNAME VARCHAR(45) NOT NULL,
ID_PERFIL INT NOT NULL,
PRIMARY KEY(USERNAME, ID_PERFIL),
FOREIGN KEY(USERNAME) REFERENCES USUARIOS(USERNAME),
FOREIGN KEY(ID_PERFIL) REFERENCES PERFILES(ID_PERFIL)
);


-- 

INSERT INTO `USUARIOS` (`USERNAME`,`PASSWORD`,`NOMBRE`,`apellidos`,`DIRECCION`,`ENABLED`,`FECHA_REGISTRO`) VALUES ('amalia','{noop}amalia','amalia','sanchez','sevilla',1,'2021-06-01');
INSERT INTO `USUARIOS` (`USERNAME`,`PASSWORD`,`NOMBRE`,`apellidos`,`DIRECCION`,`ENABLED`,`FECHA_REGISTRO`) VALUES ('cacaito@fp.com','cacaito','cacaito','lopez','madrid',1,'2021-06-01');
INSERT INTO `USUARIOS` (`USERNAME`,`PASSWORD`,`NOMBRE`,`apellidos`,`DIRECCION`,`ENABLED`,`FECHA_REGISTRO`) VALUES ('eva@fp.com','{noop}evita','eva','perez','calle jazmin 20, sevilla',1,'2021-02-01');
INSERT INTO `USUARIOS` (`USERNAME`,`PASSWORD`,`NOMBRE`,`apellidos`,`DIRECCION`,`ENABLED`,`FECHA_REGISTRO`) VALUES ('javier@fp.com','{noop}javierito','javier','perez','Madrid',1,'2021-06-01');
INSERT INTO `USUARIOS` (`USERNAME`,`PASSWORD`,`NOMBRE`,`apellidos`,`DIRECCION`,`ENABLED`,`FECHA_REGISTRO`) VALUES ('ramon@fp.com','{noop}ramoncin','ramon','chu','Madrid',1,'2021-06-01');
INSERT INTO `USUARIOS` (`USERNAME`,`PASSWORD`,`NOMBRE`,`apellidos`,`DIRECCION`,`ENABLED`,`FECHA_REGISTRO`) VALUES ('ricardo@fp.com','{noop}ricardito','ricardo','moreno','Cadiz',1,'2021-06-01');
INSERT INTO `USUARIOS` (`USERNAME`,`PASSWORD`,`NOMBRE`,`apellidos`,`DIRECCION`,`ENABLED`,`FECHA_REGISTRO`) VALUES ('sara@fp.com','{noop}sarita','sara','martinez','calle rosal 10, madrid',1,'2021-03-01');
INSERT INTO `USUARIOS` (`USERNAME`,`PASSWORD`,`NOMBRE`,`apellidos`,`DIRECCION`,`ENABLED`,`FECHA_REGISTRO`) VALUES ('tomas@fp.com','{noop}tomasin','tomas','escudero','calle alamin 30, madrid',1,'2021-01-01');

INSERT INTO `PERFILES` (`ID_PERFIL`,`NOMBRE`) VALUES (1,'ROLE_ADMINISTRADOR');
INSERT INTO `PERFILES` (`ID_PERFIL`,`NOMBRE`) VALUES (2,'ROLE_GESTOR');
INSERT INTO `PERFILES` (`ID_PERFIL`,`NOMBRE`) VALUES (3,'ROLE_CLIENTE');

INSERT INTO `USUARIO_PERFILES` (`USERNAME`,`ID_PERFIL`) VALUES ('amalia',1);
INSERT INTO `USUARIO_PERFILES` (`USERNAME`,`ID_PERFIL`) VALUES ('cacaito@fp.com',1);
INSERT INTO `USUARIO_PERFILES` (`USERNAME`,`ID_PERFIL`) VALUES ('javier@fp.com',1);
INSERT INTO `USUARIO_PERFILES` (`USERNAME`,`ID_PERFIL`) VALUES ('ramon@fp.com',1);
INSERT INTO `USUARIO_PERFILES` (`USERNAME`,`ID_PERFIL`) VALUES ('ricardo@fp.com',1);
INSERT INTO `USUARIO_PERFILES` (`USERNAME`,`ID_PERFIL`) VALUES ('tomas@fp.com',1);
INSERT INTO `USUARIO_PERFILES` (`USERNAME`,`ID_PERFIL`) VALUES ('cacaito@fp.com',2);
INSERT INTO `USUARIO_PERFILES` (`USERNAME`,`ID_PERFIL`) VALUES ('eva@fp.com',2);
INSERT INTO `USUARIO_PERFILES` (`USERNAME`,`ID_PERFIL`) VALUES ('javier@fp.com',2);
INSERT INTO `USUARIO_PERFILES` (`USERNAME`,`ID_PERFIL`) VALUES ('ricardo@fp.com',2);
INSERT INTO `USUARIO_PERFILES` (`USERNAME`,`ID_PERFIL`) VALUES ('tomas@fp.com',2);
INSERT INTO `USUARIO_PERFILES` (`USERNAME`,`ID_PERFIL`) VALUES ('sara@fp.com',3);

INSERT INTO `TIPOS` (`NOMBRE`,`DESCRIPCION`) VALUES ('WEBINAR','Conferencia online');
INSERT INTO `TIPOS` (`NOMBRE`,`DESCRIPCION`) VALUES ('CURSO','Formacion presencial');
INSERT INTO `TIPOS` (`NOMBRE`,`DESCRIPCION`) VALUES ('CONFERENCIA','Charla presencial');
INSERT INTO `TIPOS` (`NOMBRE`,`DESCRIPCION`) VALUES ('SEMINARIO','Formacion presencial');

INSERT INTO `EVENTOS` (`NOMBRE`,`DESCRIPCION`,`FECHA_INICIO`,`DURACION`,`DIRECCION`,`ESTADO`,`DESTACADO`,`AFORO_MAXIMO`,`MINIMO_ASISTENCIA`,`PRECIO`,`ID_TIPO`) VALUES ('Curso de Spring Boot','Curso de Spring Boot', '2021-06-01', 3, 'Calle Alcala 20, Madrid', 'ACTIVO', 'S', 20, 10, 100, 2);
INSERT INTO `EVENTOS` (`NOMBRE`,`DESCRIPCION`,`FECHA_INICIO`,`DURACION`,`DIRECCION`,`ESTADO`,`DESTACADO`,`AFORO_MAXIMO`,`MINIMO_ASISTENCIA`,`PRECIO`,`ID_TIPO`) VALUES ('Curso de Angular','Curso de Angular', '2021-06-01', 3, 'Calle Alcala 20, Madrid', 'NOACTIVO', 'S', 20, 10, 100, 2);
INSERT INTO `EVENTOS` (`NOMBRE`,`DESCRIPCION`,`FECHA_INICIO`,`DURACION`,`DIRECCION`,`ESTADO`,`DESTACADO`,`AFORO_MAXIMO`,`MINIMO_ASISTENCIA`,`PRECIO`,`ID_TIPO`) VALUES ('Conferencia de Angular','Conferencia de Angular', '2021-06-01', 3, 'Calle Alcala 20, Madrid', 'NOACTIVO', 'S', 20, 10, 100, 3);
INSERT INTO `EVENTOS` (`NOMBRE`,`DESCRIPCION`,`FECHA_INICIO`,`DURACION`,`DIRECCION`,`ESTADO`,`DESTACADO`,`AFORO_MAXIMO`,`MINIMO_ASISTENCIA`,`PRECIO`,`ID_TIPO`) VALUES ('Webinar de Spring Boot','Webinar de Spring Boot', '2021-06-01', 3, 'Calle Alcala 20, Madrid', 'NOACTIVO', 'S', 20, 10, 100, 1);
INSERT INTO `EVENTOS` (`NOMBRE`,`DESCRIPCION`,`FECHA_INICIO`,`DURACION`,`DIRECCION`,`ESTADO`,`DESTACADO`,`AFORO_MAXIMO`,`MINIMO_ASISTENCIA`,`PRECIO`,`ID_TIPO`) VALUES ('Curso de Java','Curso de Java', '2021-06-01', 3, 'Calle Alcala 20, Madrid', 'ACTIVO', 'S', 20, 10, 100, 2);
INSERT INTO `EVENTOS` (`NOMBRE`,`DESCRIPCION`,`FECHA_INICIO`,`DURACION`,`DIRECCION`,`ESTADO`,`DESTACADO`,`AFORO_MAXIMO`,`MINIMO_ASISTENCIA`,`PRECIO`,`ID_TIPO`) VALUES ('Webinar de Angular','Webinar de Angular', '2021-06-01', 3, 'Calle Alcala 20, Madrid', 'ACTIVO', 'S', 20, 10, 100, 1);
INSERT INTO `EVENTOS` (`NOMBRE`,`DESCRIPCION`,`FECHA_INICIO`,`DURACION`,`DIRECCION`,`ESTADO`,`DESTACADO`,`AFORO_MAXIMO`,`MINIMO_ASISTENCIA`,`PRECIO`,`ID_TIPO`) VALUES ('Webinar de Java','Webinar de Java', '2021-06-01', 3, 'Calle Alcala 20, Madrid', 'ACTIVO', 'S', 20, 10, 100, 1);
INSERT INTO `EVENTOS` (`NOMBRE`,`DESCRIPCION`,`FECHA_INICIO`,`DURACION`,`DIRECCION`,`ESTADO`,`DESTACADO`,`AFORO_MAXIMO`,`MINIMO_ASISTENCIA`,`PRECIO`,`ID_TIPO`) VALUES ('Conferencia de Spring Boot','Conferencia de Spring Boot', '2021-06-01', 3, 'Calle Alcala 20, Madrid', 'ACTIVO', 'S', 20, 10, 100, 3);




